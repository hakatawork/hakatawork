<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lunchguide Stockholm</title>
    <link rel="icon" href="data:,">
    <style>
        /* Din befintliga CSS här */
    </style>
</head>
<body>
    <header>
        <h1>Lunchguide Stockholm</h1>
        <p>Hitta perfekt lunchrestaurang i innerstaden</p>
    </header>
   
    <div class="container">
        <div class="controls">
            <div class="error" id="error-message"></div>
           
            <div class="control-group">
                <label for="area">Område:</label>
                <select id="area">
                    <option value="59.3326,18.0632">Sergels torg</option>
                    <option value="59.3258,18.0706">Gamla stan</option>
                    <option value="59.3389,18.0883">Östermalm</option>
                    <option value="59.3307,18.0415">Kungsholmen</option>
                    <option value="59.3151,18.0689">Södermalm</option>
                </select>
            </div>
           
            <div class="control-group">
                <label for="radius">
                    Sökområde (meter):
                    <span class="range-value" id="radius-value">500</span>
                </label>
                <input type="range" id="radius" min="100" max="2000" step="100" value="500">
            </div>
           
            <div class="control-group">
                <label for="min-rating">
                    Minsta betyg:
                    <span class="range-value" id="min-rating-value">3.0</span>
                </label>
                <input type="range" id="min-rating" min="0" max="5" step="0.1" value="3.0">
            </div>
           
            <div class="control-group">
                <label for="max-price">
                    Max prisnivå:
                    <span class="range-value" id="max-price-value">3 ($$$)</span>
                </label>
                <input type="range" id="max-price" min="1" max="4" step="1" value="3">
            </div>
           
            <div class="buttons">
                <button id="search-btn">Sök restauranger</button>
                <button id="random-btn" class="secondary">Slumpa restaurang</button>
            </div>
        </div>
       
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Hämtar restauranger...</p>
        </div>
       
        <div class="results" id="results">
            <div id="results-content">
                <p>Välj inställningar och klicka på "Sök restauranger" eller "Slumpa restaurang" för att börja.</p>
            </div>
        </div>
    </div>

    <script>
        class LunchGuideApp {
            constructor() {
                this.logger = {
                    info: (msg) => console.log('[INFO]', msg),
                    error: (msg, err) => console.error('[ERROR]', msg, err)
                };
                
                try {
                    this.validateDOM();
                    this.initElements();
                    this.bindEvents();
                    this.initValues();
                    this.logger.info('App initialized successfully');
                } catch (error) {
                    this.logger.error('Initialization failed', error);
                    this.showCriticalError(error.message);
                }
            }

            validateDOM() {
                const requiredElements = [
                    'area', 'radius', 'radius-value', 
                    'min-rating', 'min-rating-value',
                    'max-price', 'max-price-value',
                    'search-btn', 'random-btn',
                    'loading', 'results-content',
                    'error-message'
                ];

                const missingElements = requiredElements.filter(id => !document.getElementById(id));
                
                if (missingElements.length > 0) {
                    throw new Error(`Saknade element: ${missingElements.join(', ')}`);
                }
            }

            initElements() {
                this.elements = {
                    area: document.getElementById('area'),
                    radius: document.getElementById('radius'),
                    radiusValue: document.getElementById('radius-value'),
                    minRating: document.getElementById('min-rating'),
                    minRatingValue: document.getElementById('min-rating-value'),
                    maxPrice: document.getElementById('max-price'),
                    maxPriceValue: document.getElementById('max-price-value'),
                    searchBtn: document.getElementById('search-btn'),
                    randomBtn: document.getElementById('random-btn'),
                    loading: document.getElementById('loading'),
                    resultsContent: document.getElementById('results-content'),
                    errorMessage: document.getElementById('error-message')
                };
            }

            bindEvents() {
                this.elements.radius.addEventListener('input', () => this.updateRadiusValue());
                this.elements.minRating.addEventListener('input', () => this.updateMinRatingValue());
                this.elements.maxPrice.addEventListener('input', () => this.updateMaxPriceValue());
                this.elements.searchBtn.addEventListener('click', () => this.searchRestaurants(false));
                this.elements.randomBtn.addEventListener('click', () => this.searchRestaurants(true));
            }

            initValues() {
                this.updateMaxPriceValue();
            }

            updateRadiusValue() {
                this.elements.radiusValue.textContent = this.elements.radius.value;
            }

            updateMinRatingValue() {
                this.elements.minRatingValue.textContent = this.elements.minRating.value;
            }

            updateMaxPriceValue() {
                const prices = ['1 ($)', '2 ($$)', '3 ($$$)', '4 ($$$$)'];
                this.elements.maxPriceValue.textContent = 
                    `${this.elements.maxPrice.value} (${prices[this.elements.maxPrice.value - 1]})`;
            }

            showCriticalError(message) {
                const errorContainer = document.createElement('div');
                errorContainer.style.position = 'fixed';
                errorContainer.style.top = '0';
                errorContainer.style.left = '0';
                errorContainer.style.right = '0';
                errorContainer.style.padding = '20px';
                errorContainer.style.backgroundColor = '#e74c3c';
                errorContainer.style.color = 'white';
                errorContainer.style.zIndex = '1000';
                errorContainer.style.textAlign = 'center';
                errorContainer.textContent = message;
                document.body.prepend(errorContainer);
            }

            // Ytterligare metoder kommer här...
        }

        // Starta appen när allt är laddat
        document.addEventListener('DOMContentLoaded', () => {
            new LunchGuideApp();
        });
    </script>
</body>
</html>
