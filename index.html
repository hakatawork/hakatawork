<!DOCTYPE html>
<html lang="sv">
<head>
    <!-- Befintliga head-element förblir oförändrade -->
    <style>
        /* Lägg till denna CSS för meny-knappen */
        .menu-btn {
            background: #34a853 !important; /* Google grön */
        }
        .menu-btn:hover {
            background: #2d8e47 !important;
        }
    </style>
</head>
<body>
    <!-- Befintlig HTML förblir oförändrad fram till displayRestaurants-funktionen -->

    <script>
        // ... befintlig kod ...

        // Uppdaterad funktion för att hämta restaurangdetaljer
        function getPlaceDetails(placeId) {
            return new Promise((resolve) => {
                const service = new google.maps.places.PlacesService(document.createElement('div'));
                
                service.getDetails({
                    placeId: placeId,
                    fields: ['name', 'vicinity', 'rating', 'price_level', 'website', 'place_id', 'geometry', 'photos', 'url']
                }, (place, status) => {
                    if (status === google.maps.places.PlacesServiceStatus.OK) {
                        // Hämta bild-URL om det finns bilder
                        if (place.photos && place.photos.length > 0) {
                            try {
                                place.photoUrl = place.photos[0].getUrl({
                                    maxWidth: 400,
                                    maxHeight: 400
                                });
                            } catch (e) {
                                console.warn('Kunde inte hämta bild:', e);
                            }
                        }
                        
                        // Kontrollera om det finns en meny (vi antar att restauranger med 'lunch' i namnet har meny)
                        place.hasMenu = place.name.toLowerCase().includes('lunch') || 
                                        (place.website && place.website.includes('menu'));
                        
                        resolve(place);
                    } else {
                        console.warn(`Kunde inte hämta detaljer: ${status}`);
                        resolve(null);
                    }
                });
            });
        }

        // Uppdaterad funktion för att visa restauranger
        function displayRestaurants(restaurants, isRandom) {
            if (!restaurants || restaurants.length === 0) {
                elements['results-content'].innerHTML = '<p>Inga restauranger hittades.</p>';
                return;
            }

            let html = isRandom ? '<h2>Dagens lunchval!</h2>' : '<h2>Hittade restauranger:</h2>';
            
            restaurants.forEach(restaurant => {
                const imageHtml = restaurant.photoUrl ? 
                    `<img src="${restaurant.photoUrl}" alt="${restaurant.name}" class="restaurant-image">` : 
                    '<div class="no-image">Ingen bild</div>';

                // Skapa meny-knapp om restaurangen har meny
                const menuButton = restaurant.hasMenu ? `
                    <button class="menu-btn" onclick="window.open('${restaurant.website || restaurant.url || '#'}', '_blank')">
                        Visa lunchmeny
                    </button>
                ` : '';

                html += `
                    <div class="restaurant">
                        <div class="restaurant-image-container">
                            ${imageHtml}
                        </div>
                        <div class="restaurant-info">
                            <h3>${restaurant.name}</h3>
                            <p><strong>Adress:</strong> ${restaurant.vicinity || 'Okänd adress'}</p>
                            <p><strong>Avstånd:</strong> ${restaurant.distance || 'Okänt avstånd'}</p>
                            <p><strong>Betyg:</strong> ${restaurant.rating || 'Inget betyg'}/5</p>
                            <div class="actions">
                                <a href="https://www.google.com/maps?q=place_id:${restaurant.place_id}" target="_blank">Visa på karta</a>
                                ${restaurant.website ? `
                                    <button onclick="window.open('${restaurant.website}', '_blank')">
                                        Öppna webbplats
                                    </button>
                                ` : ''}
                                ${menuButton}
                            </div>
                        </div>
                    </div>
                `;
            });

            elements['results-content'].innerHTML = html;
        }

        // Uppdaterad mockdata
        function getMockRestaurants() {
            return [
                {
                    name: 'Restaurang Pelikan',
                    vicinity: 'Blekingegatan 40, Stockholm',
                    rating: 4.4,
                    price_level: 3,
                    website: 'https://pelikan.se',
                    place_id: 'mock1',
                    photoUrl: 'https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=400&h=400&fit=crop',
                    hasMenu: true
                },
                {
                    name: 'Kajsas Fisk',
                    vicinity: 'Hötorgshallen, Stockholm',
                    rating: 4.2,
                    price_level: 2,
                    website: 'https://kajsasfisk.se',
                    place_id: 'mock2',
                    photoUrl: 'https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=400&h=400&fit=crop',
                    hasMenu: false
                },
                {
                    name: 'Lunchrestaurang Södra',
                    vicinity: 'Södermalm, Stockholm',
                    rating: 4.0,
                    price_level: 2,
                    website: 'https://example.com/menu',
                    place_id: 'mock3',
                    hasMenu: true
                }
            ];
        }

        // ... resten av din befintliga kod ...
    </script>
</body>
</html>
